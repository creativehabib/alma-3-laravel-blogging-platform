import{_ as w}from"./Button.vue_vue_type_script_setup_true_lang-DLbVc8FY.js";import{_ as S}from"./InputError-BbPAIupT.js";import{_ as A}from"./Input.vue_vue_type_script_setup_true_lang-BYzMHQE9.js";import{_ as V}from"./Label.vue_vue_type_script_setup_true_lang-BI4_AY6J.js";import{_ as T}from"./SettingsHeader-CEyoRi1V.js";import{T as $,o as m,c as B,w as i,a as t,b as n,f as g,t as s,e as b,d as l,u as a}from"./app-DKvfoN-y.js";import{_ as D}from"./AppLayout-CDEtE47D.js";import"./index-T_RycVZ9.js";import"./useThemeConfig-CMn459mP.js";import"./Link-BxabHujp.js";import"./arrow-left-linear-CzdGo5D7.js";import"./moon-stars-linear-DuqhdEj6.js";import"./facebook-BuDmhaaR.js";import"./Switch.vue_vue_type_script_setup_true_lang-C7ZMvNjL.js";import"./ButtonLink.vue_vue_type_script_setup_true_lang-CgLFBnw-.js";import"./alarm-linear-B0PzHQQx.js";import"./Logo-dKRd1DwS.js";const x={class:"block bg-background sm:rounded-lg pb-2 w-full"},E={key:0,class:"p-6"},F={class:"mt-4 text-sm text-foreground"},H={class:"flex flex-col items-center gap-1 mt-4 text-sm border border-border rounded-lg p-2"},L=["innerHTML"],M={class:"flex items-center gap-x-1 mt-4 text-sm"},N={class:"flex items-center gap-4 mt-5"},q={key:1,class:"p-6"},I={class:"flex items-center gap-4 mt-5"},oe={__name:"TwoFactorAuth",props:{user:Object,qr_code:String,secretKey:String},setup(r){const u=r,e=$({otp_code:""}),v=()=>{e.post(route("user.settings.tfa.activate",u.user),{onSuccess:()=>e.reset("otp_code")})},y=()=>{e.post(route("user.settings.tfa.deactivate",u.user),{onSuccess:()=>e.reset("otp_code")})};return(o,c)=>{const k=T,_=V,p=A,f=S,h=w;return m(),B(D,null,{default:i(()=>[t("div",x,[n(k,{user:r.user,title:o.__("Two Factor Authentication")},null,8,["user","title"]),r.user.google2fa_status===0?(m(),g("section",E,[t("h2",null,s(o.__("Activate two factor authentication")),1),t("p",F,s(o.__("To finish enabling two factor authentication, scan the QR code below or use setup key on your Google Authenticator app to add your account or enter the setup key and provide the generated OTP code.")),1),t("div",H,[t("h2",null,s(o.__("Scan the QR code")),1),t("div",{innerHTML:r.qr_code,class:"inline-block bg-white"},null,8,L),t("div",M,[t("span",null,s(o.__("Secret key:")),1),t("span",null,s(r.secretKey),1)])]),t("form",{onSubmit:b(v,["prevent"]),class:"mt-5"},[n(_,null,{default:i(()=>[l(s(o.__("Enter the code from the Authenticator app")),1)]),_:1}),n(p,{modelValue:a(e).otp_code,"onUpdate:modelValue":c[0]||(c[0]=d=>a(e).otp_code=d)},null,8,["modelValue"]),n(f,{class:"mt-1",message:a(e).errors.otp_code},null,8,["message"]),t("div",N,[n(h,{disabled:a(e).processing||!a(e).isDirty,variant:"default"},{default:i(()=>[l(s(o.__("Activate")),1)]),_:1},8,["disabled"])])],32)])):(m(),g("section",q,[t("h2",null,s(o.__("Deactivate two factor authentication")),1),t("form",{onSubmit:b(y,["prevent"]),class:"mt-5"},[n(_,null,{default:i(()=>[l(s(o.__("Enter the code from the Authenticator app")),1)]),_:1}),n(p,{modelValue:a(e).otp_code,"onUpdate:modelValue":c[1]||(c[1]=d=>a(e).otp_code=d)},null,8,["modelValue"]),n(f,{class:"mt-1",message:a(e).errors.otp_code},null,8,["message"]),t("div",I,[n(h,{disabled:a(e).processing||!a(e).isDirty,variant:"default"},{default:i(()=>[l(s(o.__("Deactivate")),1)]),_:1},8,["disabled"])])],32)]))])]),_:1})}}};export{oe as default};
